<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>JNK Express Padala - Track Your Package</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <style>
    /* Reset */
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #ff4d4d, #ff9966);
      color: #333;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Floating animated shapes */
    .blob {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      animation: float 12s infinite ease-in-out;
      z-index: 0;
    }
    .blob:nth-child(1) { width: 300px; height: 300px; top: 10%; left: -100px; }
    .blob:nth-child(2) { width: 200px; height: 200px; bottom: 10%; right: -80px; animation-delay: 3s; }
    @keyframes float {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-40px) scale(1.05); }
    }

    header {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(8px);
      color: #fff;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 1;
      position: relative;
    }
    header img { height: 50px; border-radius: 10px; }
    header h1 { font-size: 1.6em; }

    nav {
      text-align: center;
      margin: 15px auto;
      z-index: 1;
      position: relative;
    }
    nav button {
      margin: 5px;
      padding: 10px 16px;
      border: 1px solid #fff;
      background: transparent;
      color: #fff;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
    }
    nav button:hover {
      background: #fff;
      color: #ff4d4d;
    }

    .container {
      max-width: 700px;
      margin: 30px auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 6px 30px rgba(0,0,0,0.2);
      padding: 2em;
      text-align: center;
      position: relative;
      z-index: 1;
    }
    .tracking-bar {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    .tracking-bar input {
      flex: 1;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1em;
    }
    .track-btn {
      padding: 12px 18px;
      border: none;
      background: #ff4d4d;
      color: white;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
    }
    .track-btn:hover { background: #e63939; }

    #loading { margin-top: 10px; color: #ff4d4d; display: none; }

    .status-box {
      margin-top: 20px;
      padding: 20px;
      background: #fdf1f1;
      border-radius: 10px;
      text-align: center;
      display: none;
    }

    /* Timeline */
    .timeline {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      position: relative;
    }
    .timeline-step {
      flex: 1;
      text-align: center;
      position: relative;
    }
    .timeline-step::before {
      content: "";
      position: absolute;
      top: 20px;
      left: 50%;
      width: 100%;
      height: 4px;
      background: #ddd;
      z-index: -1;
      transform: translateX(-50%);
    }
    .timeline-step:first-child::before { display: none; }
    .timeline-icon {
      width: 40px; height: 40px;
      border-radius: 50%;
      background: #ccc;
      margin: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }
    .timeline-step.active .timeline-icon {
      background: #ff4d4d;
      box-shadow: 0 0 12px rgba(255,77,77,0.8);
    }

    .map-box { margin-top: 20px; border-radius: 10px; overflow: hidden; }

    /* Sections */
    .section {
      max-width: 700px;
      margin: 30px auto;
      background: #fff;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      z-index: 1;
      position: relative;
    }
    .section h3 { color: #ff4d4d; margin-bottom: 10px; }

    /* Collapsibles */
    .collapsible {
      width: 100%;
      background: #ff4d4d;
      color: white;
      padding: 12px;
      border: none;
      border-radius: 6px;
      margin-top: 10px;
      text-align: left;
      font-size: 1em;
      cursor: pointer;
    }
    .collapsible:after { content: '\002B'; float: right; }
    .collapsible.active:after { content: '\2212'; }
    .content { padding: 10px; display: none; }

    /* Floating Support Button */
    .support-btn {
      position: fixed;
      bottom: 90px;
      right: 20px;
      background-color: #ff4d4d;
      color: white;
      padding: 12px 18px;
      border-radius: 25px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    .support-form {
      position: fixed;
      bottom: 150px;
      right: 20px;
      width: 300px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      padding: 1em;
      display: none;
      z-index: 1001;
    }
    .support-form input, .support-form textarea {
      width: 100%; padding: 10px; margin-top: 8px;
      border-radius: 6px; border: 1px solid #ccc;
    }
    .support-form button {
      background: #ff4d4d; color: white; border: none;
      margin-top: 10px; padding: 10px; border-radius: 6px;
      cursor: pointer;
    }

    footer {
      background: #ff4d4d;
      color: white;
      text-align: center;
      padding: 15px;
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <!-- Floating animated shapes -->
  <div class="blob"></div>
  <div class="blob"></div>

  <header>
    <img src="logo.jpg" alt="Logo" />
    <h1>JNK Express Padala</h1>
    <a href="admin.html" style="color:white;text-decoration:none;">Login</a>
  </header>

  <nav>
    <button onclick="document.getElementById('trackingInput').focus()">Track & Trace</button>
    <button onclick="alert('Shipping Rates - Coming Soon!')">Shipping Rates</button>
    <button onclick="alert('Shipping Days - Coming Soon!')">Shipping Days</button>
    <button onclick="alert('Find Branches - Coming Soon!')">Find Branches</button>
  </nav>

  <div class="container">
    <h2>Track Your Package</h2>
    <div class="tracking-bar">
      <input type="text" id="trackingInput" placeholder="Enter your tracking number" />
      <button class="track-btn" onclick="trackPackage()">Track</button>
    </div>
    <div id="loading">‚è≥ Loading...</div>
    <div id="statusResult" class="status-box"></div>
    <div id="mapContainer" class="map-box"></div>
  </div>

  <div class="section">
    <h3>Our Services</h3>
    <p><strong>Package Courier:</strong> Fast delivery from Urban to Lubang and vice versa!</p>
    <p><strong>Sea Freight:</strong> Best rates, starting at just ‚Ç±20!</p>
    <p><strong>Bulk/Truck Services:</strong> Large shipments like Balikbayan boxes, appliances, handled with care.</p>
  </div>

  <div class="section">
    <h3>üìç Pick-up Locations</h3>
    <ul>
      <li><strong>Main Branch:</strong> Urban Finds by JNK, Andres Bonifacio HW, Brgy. Araw at Bituin</li>
      <li><strong>Tilik:</strong> E. Arnaldo St. (Near NFA‚Äôs Warehouse)</li>
      <li><strong>Vigo/Dangay:</strong> Near Dangay Church</li>
      <li><strong>Tagbac:</strong> 104 Guijo St., Extension (West)</li>
      <li><strong>Binacas:</strong> 213 Kasoy St. (In front of plaza)</li>
      <li><strong>Cabra:</strong> 037 Bayabas St., Libis</li>
    </ul>
  </div>

  <div class="section">
    <button class="collapsible">About Us</button>
    <div class="content">
      <p>JNK Express Padala is dedicated to safe, quick, and reliable delivery from Urban to Lubang and beyond.</p>
    </div>
    <button class="collapsible">Privacy Policy</button>
    <div class="content">
      <p>We respect your privacy and ensure your personal information is protected.</p>
    </div>
    <button class="collapsible">Cookie Policy</button>
    <div class="content">
      <p>We may use cookies to enhance your experience.</p>
    </div>
    <button class="collapsible">Terms & Conditions</button>
    <div class="content">
      <p>By using our services, you agree to provide accurate information.</p>
    </div>
    <button class="collapsible">Refund & Shipping Policy</button>
    <div class="content">
      <p>Shipping fees are non-refundable once dispatched.</p>
    </div>
  </div>

  <div class="support-btn" onclick="toggleSupportForm()">üí¨ Support</div>
  <div class="support-form" id="supportForm">
    <form action="https://formsubmit.co/jhonyhix@gmail.com" method="POST">
      <input type="hidden" name="_captcha" value="false">
      <input type="text" name="Name" placeholder="Your Name" required />
      <input type="text" name="Tracking Number" placeholder="Tracking Number" required />
      <textarea name="Message" rows="3" placeholder="Your message" required></textarea>
      <button type="submit">Send Message</button>
    </form>
  </div>

  <footer>
    &copy; 2025 JNK Express Padala. All Rights Reserved. | 
    <a href="https://www.facebook.com/profile.php?id=61572021585621" style="color:white;text-decoration:underline;">Facebook</a>
  </footer>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyAnrNfuTSRAKUS2tAU4AUUrauw_QzszCjY",
      authDomain: "jnk-ordertracker.firebaseapp.com",
      projectId: "jnk-ordertracker",
      storageBucket: "jnk-ordertracker.appspot.com",
      messagingSenderId: "421193030070",
      appId: "1:421193030070:web:078e39980237bc41f64917"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const STAGES = [
      { name: "Package Received", icon: "üì¶" },
      { name: "In Transit", icon: "üöö" },
      { name: "Arrived", icon: "üìç" },
      { name: "For Pick-up", icon: "‚úÖ" }
    ];

    async function trackPackage() {
      const input = document.getElementById('trackingInput').value.trim().toUpperCase();
      const resultDiv = document.getElementById('statusResult');
      const loadingDiv = document.getElementById('loading');
      const mapDiv = document.getElementById('mapContainer');

      resultDiv.style.display = 'none'; 
      mapDiv.style.display = 'none'; 
      loadingDiv.style.display = 'block';

      if (!input) { 
        alert("Enter tracking number"); 
        loadingDiv.style.display = 'none'; 
        return; 
      }

      try {
        let data = null;

        // Try doc ID in "tracking"
        const docRef = await db.collection("tracking").doc(input).get();
        if (docRef.exists) {
          data = docRef.data();
        } else {
          // Try field "trackingNumber"
          const q = await db.collection("tracking").where("trackingNumber", "==", input).limit(1).get();
          if (!q.empty) data = q.docs[0].data();
        }

        if (!data) {
          resultDiv.innerHTML = `<p style="color:red;">‚ùå Tracking number not found.</p>`;
        } else {
          resultDiv.innerHTML = `
            <h3>üì¶ Tracking Number: ${input}</h3>
            <p><strong>Status:</strong> ${data.status || "Unknown"}</p>
            <p><strong>Destination:</strong> ${data.destination || "N/A"}</p>
            <p><strong>Updated At:</strong> ${data.updatedAt || "N/A"}</p>
            <div class="timeline">
              ${STAGES.map(stage => `
                <div class="timeline-step ${stage.name === data.status ? 'active' : ''}">
                  <div class="timeline-icon">${stage.icon}</div>
                  <div class="timeline-label">${stage.name}</div>
                </div>`).join('')}
            </div>
          `;
          if (data.location) {
            const [lat, lng] = data.location.split(",");
            mapDiv.innerHTML = `<iframe src="https://maps.google.com/maps?q=${lat},${lng}&z=14&output=embed" width="100%" height="300" style="border:0;"></iframe>`;
            mapDiv.style.display = 'block';
          }
        }
        resultDiv.style.display = 'block';
      } catch (e) {
        console.error("‚ùå Error:", e);
        resultDiv.innerHTML = `<p style="color:red;">‚ö†Ô∏è Error fetching data. Check console.</p>`;
      }
      loadingDiv.style.display = 'none';
    }

    // Support Form Toggle
    function toggleSupportForm() {
      const form = document.getElementById('supportForm');
      form.style.display = form.style.display === 'block' ? 'none' : 'block';
    }

    // Collapsible sections
    const coll = document.getElementsByClassName("collapsible");
    for (let i = 0; i < coll.length; i++) {
      coll[i].addEventListener("click", function() {
        this.classList.toggle("active");
        const content = this.nextElementSibling;
        content.style.display = content.style.display === "block" ? "none" : "block";
      });
    }
  </script>
</body>
</html>
